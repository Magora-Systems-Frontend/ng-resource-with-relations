!function(){"use strict";function t(){this.$get=["$resource","$q","$injector",function(t,e,i){return function(n,r,o,a,u){void 0===r&&(r={});var s=t(n,o,a,u);return s._with=function(t,i,n,r){return void 0===i&&(i=[]),void 0===n&&(n={}),function(i,n,r){return s[t](n,function(t){var n=[];if(t instanceof Array)for(var o=0;o<t.length;o++)n.push(t[o].$getRelations(i));else n.push(t.$getRelations(i));return e.all(n).then(function(){r&&r(t)})})}(i,n,r)},s.queryWith=function(t,e,i){return this._with("query",t,e,i)},s.getWith=function(t,e,i){return this._with("get",t,e,i)},angular.extend(s.prototype,{relations:r,$getRelations:function(t){var n=this;void 0===t?t=[]:"string"==typeof t&&(t=[t]);for(var r=e.defer(),o=[],a=0;a<t.length;a++){var u=t[a];if("string"==typeof u){var s=u.split(".");u={model:s[0],params:{},"with":[]},void 0!=s[1]&&u["with"].push(s[1])}if(u=angular.extend({model:null,params:{},"with":[]},u),void 0!==this.relations[u.model]){var l=this.relations[u.model],h=i.get(l.modelName),c="get";void 0!==l.collection?(n[u.model]=[],c="query",u.params[l.via]=this.id):u.params.id=this[l.model],function(t,e,i){e.push(t["with"].length?h[c+"With"](t["with"],t.params,function(e){i[t.model]=e}):h[c](t.params,function(e){i[t.model]=e}))}(u,o,n)}e.all(o).then(function(){r.resolve(n)})}return r.promise}}),s}}]}angular.module("mgr.ngResourceWithRelations",["ngResource"]).provider("$resourceWithRelations",t)}();