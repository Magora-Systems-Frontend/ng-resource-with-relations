!function(){"use strict";function t(){var t=this;this.defaults={url:"/"},this.$get=["$resource","$q","$injector",function(e,i,n){return function(r,o,u,a,s){void 0===o&&(o={});var l=e(t.defaults.url+r,u,a,s);return l._with=function(t,e,n,r){return void 0===e&&(e=[]),void 0===n&&(n={}),function(e,n,r){return l[t](n,function(t){var n=[];if(t instanceof Array)for(var o=0;o<t.length;o++)n.push(t[o].$getRelations(e));else n.push(t.$getRelations(e));return i.all(n).then(function(){r&&r(t)})})}(e,n,r)},l.queryWith=function(t,e,i){return this._with("query",t,e,i)},l.getWith=function(t,e,i){return this._with("get",t,e,i)},angular.extend(l.prototype,{relations:o,$getRelations:function(t){var e=this;void 0===t?t=[]:"string"==typeof t&&(t=[t]);for(var r=i.defer(),o=[],u=0;u<t.length;u++){var a=t[u];if("string"==typeof a){var s=a.split(".");a={model:s[0],params:{},"with":[]},void 0!=s[1]&&a["with"].push(s[1])}if(a=angular.extend({model:null,params:{},"with":[]},a),void 0!==this.relations[a.model]){var l=this.relations[a.model],h=n.get(l.modelName),f="get";void 0!==l.collection?(e[a.model]=[],f="query",a.params[l.via]=this.id):a.params.id=this[l.model],function(t,e,i){e.push(t["with"].length?h[f+"With"](t["with"],t.params,function(e){i[t.model]=e}):h[f](t.params,function(e){i[t.model]=e}))}(a,o,e)}i.all(o).then(function(){r.resolve(e)})}return r.promise}}),l}}]}angular.module("mgr.ngResourceWithRelations",["ngResource"]).provider("$resourceWithRelations",t)}();